<Window x:Class="RestaurantManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sistem de gestiune restaurant" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">

    <TabControl x:Name="RootTabs" Margin="12">
        <!-- TAB 1: MENIU -->
        <TabItem x:Name="MenuTab" Header="Meniu">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Administrare meniu" FontSize="22" FontWeight="Bold"/>

                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="3*"/>
                        <ColumnDefinition Width="12"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Lista cu produse -->
                    <DataGrid Grid.Column="0"
                              ItemsSource="{Binding Items}"
                              SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              IsReadOnly="False"
                              Margin="0,0,0,8">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Nume" Binding="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                            <DataGridTextColumn Header="Categorie" Binding="{Binding Category, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                            <DataGridTextColumn Header="Preț" Binding="{Binding Price, StringFormat={}{0:F2}, UpdateSourceTrigger=PropertyChanged}" Width="80"/>
                            <DataGridCheckBoxColumn Header="Disponibil" Binding="{Binding IsAvailable}" Width="90"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Formular adăugare produs -->
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Adaugă produs nou" FontWeight="SemiBold" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Nume" Width="80" VerticalAlignment="Center"/>
                            <TextBox Text="{Binding NewItem.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Categorie" Width="80" VerticalAlignment="Center"/>
                            <TextBox Text="{Binding NewItem.Category, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Preț" Width="80" VerticalAlignment="Center"/>
                            <TextBox Text="{Binding NewItem.Price, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,
                                            ValidatesOnDataErrors=True, ValidatesOnExceptions=True, NotifyOnValidationError=True}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="Disponibil" Width="80" VerticalAlignment="Center"/>
                            <CheckBox IsChecked="{Binding NewItem.IsAvailable, Mode=TwoWay}"/>
                        </StackPanel>

                        <WrapPanel>
                            <Button Content="Adaugă" Command="{Binding AddCommand}" Width="100" Margin="0,0,8,0"/>
                            <Button Content="Salvează modificările" Command="{Binding SaveCommand}" Width="160" Margin="0,0,8,0"/>
                            <Button Content="Șterge selectatul" Command="{Binding DeleteCommand}" Width="140"/>
                        </WrapPanel>
                    </StackPanel>
                </Grid>
            </Grid>
        </TabItem>

        <!-- TAB 2: COMENZI -->
        <TabItem x:Name="OrdersTab" Header="Comenzi">
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1.2*"/>
                    <ColumnDefinition Width="2.2*"/>
                    <ColumnDefinition Width="1.6*"/>
                </Grid.ColumnDefinitions>

                <!-- Mese -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Mese" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <ListBox ItemsSource="{Binding Tables}"
                             SelectedItem="{Binding SelectedTable, Mode=TwoWay}"
                             DisplayMemberPath="Name"
                             Height="420"/>
                </StackPanel>

                <!-- Meniu pentru adăugare rapidă -->
                <StackPanel Grid.Column="1" Margin="12,0">
                    <TextBlock Text="Meniu" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <ListView x:Name="MenuList"
                              ItemsSource="{Binding Menu}"
                              Height="380"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Produs" Width="200" DisplayMemberBinding="{Binding Name}"/>
                                <GridViewColumn Header="Categorie" Width="140" DisplayMemberBinding="{Binding Category}"/>
                                <GridViewColumn Header="Preț" Width="80" DisplayMemberBinding="{Binding Price}"/>
                                <GridViewColumn Header="" Width="60">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="+"
                                                    Command="{Binding DataContext.AddItemCommand, ElementName=OrdersTab}"
                                                    CommandParameter="{Binding}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <Button Content="Adaugă (+)"
                            Margin="0,8,0,0"
                            Width="120"
                            HorizontalAlignment="Left"
                            Command="{Binding AddItemCommand}"
                            CommandParameter="{Binding SelectedItem, ElementName=MenuList}"/>
                </StackPanel>

                <!-- Comanda curentă + Încasări -->
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Comanda curentă" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <DataGrid ItemsSource="{Binding CurrentItems}"
                              SelectedItem="{Binding SelectedOrderItem, Mode=TwoWay}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              Height="300">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Produs" Binding="{Binding MenuItem.Name}" Width="*" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Cant."  Binding="{Binding Quantity}" Width="60"  IsReadOnly="True"/>
                            <DataGridTextColumn Header="Preț"   Binding="{Binding UnitPrice}" Width="80" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Subtotal" Binding="{Binding Subtotal}" Width="90" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <WrapPanel Margin="0,8,0,0">
                        <Button Content="+1" Command="{Binding IncreaseQtyCommand}" Width="50" Margin="0,0,6,0"/>
                        <Button Content="-1" Command="{Binding DecreaseQtyCommand}" Width="50" Margin="0,0,6,0"/>
                        <Button Content="Șterge" Command="{Binding RemoveItemCommand}" Width="80"/>
                    </WrapPanel>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <TextBlock Text="Total:" FontSize="16" FontWeight="SemiBold" Margin="0,0,8,0"/>
                        <TextBlock Text="{Binding Total, StringFormat={}{0:F2} lei}" FontSize="16" FontWeight="Bold"/>
                    </StackPanel>

                    <Button Content="Încasează (Plătit)" Command="{Binding PayCommand}" Height="36" Margin="0,8,0,0" HorizontalAlignment="Right" Width="180"/>

                    <Separator Margin="0,8,0,8"/>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <TextBlock Text="Încasări azi:" Margin="0,0,8,0"/>
                        <TextBlock Text="{Binding RevenueToday, StringFormat={}{0:F2} lei}" FontWeight="Bold" Margin="0,0,16,0"/>
                        <TextBlock Text="Încasări totale:" Margin="0,0,8,0"/>
                        <TextBlock Text="{Binding RevenueAllTime, StringFormat={}{0:F2} lei}" FontWeight="Bold" Margin="0,0,16,0"/>
                        <Button Content="Reîmprospătează" Command="{Binding RefreshRevenueCommand}" Width="130"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </TabItem>
    </TabControl>
</Window>
